<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Predicates</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Discrete event simulation</span> <span class="project-version">1.0.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="control.html"><div class="inner"><span>Control </span></div></a></li><li class="depth-1 "><a href="entity.html"><div class="inner"><span>Entity</span></div></a></li><li class="depth-1  current"><a href="predicates.html"><div class="inner"><span>Predicates</span></div></a></li><li class="depth-1 "><a href="simulation_engine.html"><div class="inner"><span>Simulation engine</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>automaton-simulation-de</span></div></div></li><li class="depth-2"><a href="automaton-simulation-de.control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>control</span></div></a></li><li class="depth-3"><a href="automaton-simulation-de.control.computation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>computation</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.control.computation.impl.chunk.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chunk</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.control.computation.impl.direct.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>direct</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.control.computation.registry.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4"><a href="automaton-simulation-de.control.computation.response.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>response</span></div></a></li><li class="depth-3"><a href="automaton-simulation-de.control.state.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-2 branch"><a href="automaton-simulation-de.entity.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>entity</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>event-library</span></div></div></li><li class="depth-3"><a href="automaton-simulation-de.event-library.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-2"><a href="automaton-simulation-de.predicates.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>predicates</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.predicates.composed-predicates.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>composed-predicates</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.predicates.equality-predicates.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>equality-predicates</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4"><a href="automaton-simulation-de.predicates.impl.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-2"><a href="automaton-simulation-de.rc.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>rc</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>preemption-policy</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.rc.impl.preemption-policy.base.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>base</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.rc.impl.preemption-policy.factory.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>factory</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.rc.impl.preemption-policy.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4"><a href="automaton-simulation-de.rc.impl.resource.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>resource</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.rc.impl.resource.consumption.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>consumption</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.rc.impl.resource.queue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>queue</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.rc.impl.state.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>unblocking-policy</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.rc.impl.unblocking-policy.base.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>base</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.rc.impl.unblocking-policy.factory.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>factory</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.rc.impl.unblocking-policy.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.rc.preemption-policy.html"><div class="inner"><span class="tree" style="top: -393px;"><span class="top" style="height: 402px;"></span><span class="bottom"></span></span><span>preemption-policy</span></div></a></li><li class="depth-3"><a href="automaton-simulation-de.rc.unblocking-policy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>unblocking-policy</span></div></a></li><li class="depth-2"><a href="automaton-simulation-de.simulation-engine.html"><div class="inner"><span class="tree" style="top: -486px;"><span class="top" style="height: 495px;"></span><span class="bottom"></span></span><span>simulation-engine</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.event.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>event</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.event-execution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>event-execution</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.event-return.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>event-return</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>built-in-sd</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.causality-broken.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causality-broken</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.execution-not-found.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>execution-not-found</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.failed-event-execution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>failed-event-execution</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.no-future-events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>no-future-events</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.request-validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>request-validation</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.simulation-engine.impl.built-in-sd.response-validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>response-validation</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.event-registry.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>event-registry</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.middleware.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.middleware.request-validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>request-validation</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.middleware.response-validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>response-validation</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.middleware.state-rendering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state-rendering</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.simulation-engine.impl.middleware.tapping.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tapping</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.middlewares.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>middlewares</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.model-data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model-data</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ordering</span></div></div></li><li class="depth-5"><a href="automaton-simulation-de.simulation-engine.impl.ordering.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.registry.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4 branch"><a href="automaton-simulation-de.simulation-engine.impl.scheduler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scheduler</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stopping-definition</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping-definition.bucket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bucket</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping-definition.iteration-nth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>iteration-nth</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping-definition.now.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>now</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping-definition.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.simulation-engine.impl.stopping-definition.state-contains.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state-contains</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>stopping</span></div></div></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping.cause.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cause</span></div></a></li><li class="depth-5 branch"><a href="automaton-simulation-de.simulation-engine.impl.stopping.criteria.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>criteria</span></div></a></li><li class="depth-5"><a href="automaton-simulation-de.simulation-engine.impl.stopping.definition.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>definition</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.middleware.html"><div class="inner"><span class="tree" style="top: -1013px;"><span class="top" style="height: 1022px;"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.ordering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ordering</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.orderings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>orderings</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.request.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>request</span></div></a></li><li class="depth-3 branch"><a href="automaton-simulation-de.simulation-engine.response.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>response</span></div></a></li><li class="depth-3"><a href="automaton-simulation-de.simulation-engine.snapshot.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-refresh-toc -->
**Table of Contents**
<ul>
<li><a href="#transformation">Transformation</a>
<ul>
<li><a href="#predicates-query-language">Predicates query language</a>
<ul>
<li><a href="#equality-predicates">Equality predicates</a></li>
<li><a href="#composed-predicates">Composed predicates</a></li>
</ul>
</li>
<li><a href="#predicates-advanced">Predicates advanced</a>
<ul>
<li><a href="#adding-custom-made-predicate">Adding custom-made predicate</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- markdown-toc end -->
<h1><a href="#predicates" id="predicates"></a>Predicates</h1>
<p>The Predicates module contains functions that return a boolean or nil if the values can’t be compared and a small DSL to represent and apply them.</p>
<h2><a href="#equality-predicates" id="equality-predicates"></a>Equality predicates</h2>
<p>Equality predicates are predicates that return a boolean based on a comparison of values</p>
<pre><code class="language-clojure">(ns transformation-doc)

(require '[automaton-simulation-de.predicates :as sim-pred])

(1) (def my-data {:name :m1
                  :color :blue})

(2) (def pred-intent [::sim-pred/equal? :color :blue])

(3) (sim-pred/apply-predicate-query pred-intent my-data)
;;=&gt; true
</code></pre>
<p>(1) The data structure to apply the predicate to.</p>
<p>(2) User predicate in the form of a vector.</p>
<p>The schema for that predicate vector is: <a href=":predicate-id &amp; :predicate-params">:predicate-id &amp; :predicate-params</a></p>
<p>:predicate-id is expected to match a keyword in the predicates-registry (which is located in sim-pred/predicates-registry). If you need custom predicates head to <a href="Adding custom-made predicate">Adding custom-made predicate</a>.</p>
<p>:predicate-params are what will be passed to predicate-fn and can vary in numbers of parameters and value types, depending on the predicate used.</p>
<p>The predicate we are using here: <code>::sim-pred/equal?</code> expects two params: 1. a path in the form of a keyword or vector (here <code>:color</code>) 2. a value to compare the value under the path with (<code>:blue</code>) If the value under a path matches the second value passed to it, it will return true.</p>
<p>(3) This function will take a predicate language query, turn it into a function, and apply to function second parameter (<code>my-data</code> (1))</p>
<p>Which has <code>:blue</code> under :color so it returns true</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/equal? :blue])
(sim-pred/apply-predicate-query pred-intent my-data) 
;;=&gt; false
(sim-pred/apply-predicate-query pred-intent :blue)
;; =&gt; true
(sim-pred/apply-predicate-query [::sim-pred/equal? {:color :blue}] {:color :blue})
;; =&gt; true

</code></pre>
<p>When only one argument is passed to <code>::sim-pred/equal?</code> it will compare the whole value passed to it.</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/equal? :color :red])
(sim-pred/apply-predicate-query pred-intent my-data) 
;;   =&gt; false 
</code></pre>
<p>Value under :color is :blue, so asking for :red will return false</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/equal? [:mix :color] :blue])
(sim-pred/apply-predicate-query pred-intent my-data) 
;;   =&gt; false 
</code></pre>
<p>There is nothing under :mix :color path in our data, so it returns false</p>
<p>Most of the predicates expect the same params as <code>::sim-pred/equal?</code></p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/one-of? :color [:blue :red]])

(sim-pred/apply-predicate-query pred-intent {:color :red})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:color :blue})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:color :green})
;;=&gt; false
</code></pre>
<p>one-of is similar to ::sim-pred/equal?, with the difference that it compares the value under the path with all the values in the collection passed to it and returns true if ANY of them match.</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/contains? :name "m1"])

(sim-pred/apply-predicate-query pred-intent {:name "m1"})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:name "m1sadw21"})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:name "whatever-m1"})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:name "don't m have it 1"})
;;=&gt; false
</code></pre>
<p>::sim-pred/contains will return true if the value under the specified path contains the value passed in the argument</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/contains? :colors :blue])

(sim-pred/apply-predicate-query pred-intent {:colors [:blue]})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:colors '(:green :red :blue)})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:colors [:red :yellow]})
;;=&gt; false 

(sim-pred/apply-predicate-query pred-intent {:colors nil})
;;=&gt; false
</code></pre>
<p>Contains works on different value types</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/true? :turned-on])

(sim-pred/apply-predicate-query pred-intent {:turned-on true})
;;=&gt; true

(sim-pred/apply-predicate-query pred-intent {:turned-on false})
;;=&gt; false

(sim-pred/apply-predicate-query pred-intent {:turned-on "Yes I am"})
;;=&gt; false

(sim-pred/apply-predicate-query pred-intent {:different-key true})
;;=&gt; false
</code></pre>
<p>true? the predicate that will return true only if there is a boolean true value</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/&gt; :capacity 5])

(sim-pred/apply-predicate-query pred-intent {:capacity 6})
;; =&gt; true

(sim-pred/apply-predicate-query pred-intent {:capacity 1})
;; =&gt; false

(sim-pred/apply-predicate-query pred-intent {:capacity "NaN"})
;; =&gt; nil

</code></pre>
<p>But not all predicates work for all value types,</p>
<p>::sim-pred/&gt; will expect that it’s comparing numbers</p>
<p>If it’s not able to compare, it returns nil.</p>
<h2><a href="#composed-predicates" id="composed-predicates"></a>Composed predicates</h2>
<p>But there are also composed predicates, which expect as a parameter one or more predicates and return boolean based on them.</p>
<pre><code class="language-clojure">(def pred-intent [::sim-pred/and [::sim-pred/equal? :color :blue] [::sim-pred/&gt; :capacity 5]]

(sim-pred/apply-predicate-query pred-intent {:color :blue
                                              :capacity 6})
;;=&gt; true
(sim-pred/apply-predicate-query pred-intent {:color :blue
                                              :capacity 3})
;;=&gt; false
(sim-pred/apply-predicate-query pred-intent {:color :green
                                              :capacity 6})
;;=&gt; false
(sim-pred/apply-predicate-query pred-intent {:color :green
                                              :capacity 1})
;;=&gt; false
</code></pre>
<p>And needs all of their predicates to return true.</p>
<pre><code class="language-clojure">(def or-pred-intent [::sim-pred/or [::sim-pred/equal? :color :blue] [::sim-pred/&gt; :capacity 5]]

(sim-pred/apply-predicate-query or-pred-intent {:color :blue
                                              :capacity 6})
;;=&gt; true
(sim-pred/apply-predicate-query or-pred-intent {:color :blue
                                              :capacity 3})
;;=&gt; true
(sim-pred/apply-predicate-query or-pred-intent {:color :green
                                              :capacity 6})
;;=&gt; true

(sim-pred/apply-predicate-query or-pred-intent {:color :green
                                              :capacity 1})
;;=&gt; false
</code></pre>
<p>::sim-pred/or will require any of predicates to be true to return true</p>
<pre><code class="language-clojure">(def not-pred-intent [::sim-pred/not pred-intent]

(sim-pred/apply-predicate-query or-pred-intent {:color :blue
                                              :capacity 6})
;;=&gt; false
(sim-pred/apply-predicate-query or-pred-intent {:color :blue
                                              :capacity 3})
;;=&gt; false
(sim-pred/apply-predicate-query or-pred-intent {:color :green
                                              :capacity 6})
;;=&gt; false

(sim-pred/apply-predicate-query or-pred-intent {:color :green
                                              :capacity 1})
;;=&gt; true
</code></pre>
<p>::sim-pred/not will reverse the value returned by the predicate inside of it</p>
<h2><a href="#predicates-advanced" id="predicates-advanced"></a>Predicates advanced</h2>
<h3><a href="#adding-custom-made-predicate" id="adding-custom-made-predicate"></a>Adding custom-made predicate</h3>
<pre><code class="language-clojure">
(1) (defn is-nil? [path]
    (fn [v]
     (= (get v path) nil)))

(2) (def my-custom-pred-reg {::is-nil? {:pred-fn is-nil?}}) 

(3)  (sim-pred/apply-predicate-query 
    (merge sim-pred/predicates-lang-reg
           my-custom-pred-reg)
    [::is-nil? :color] 
    {:color ["hello" "world" "predicates"]})
;;=&gt; false
</code></pre>
<p>(1) we declare a predicate function. All parameters of that function will be what is expected as vector language params. It can accept any number of params, could be also no params.</p>
<p>The function is expected to return a function that as a parameter accepts a value that will be used for comparison which result should be: true - when it matches the predicate false - when not nil - if it’s impossible to tell</p>
<p>In this particular function, we expect that our query will look like this: <a href="::is-nil? :path">::is-nil? :path</a> which turned into a function will look into the value path and return true if it’s nil.</p>
<p>(2) We define our custom registry. It needs to follow only two rules: the name of the predicate is a keyword in the map value is a map containing :pred-fn and the corresponding function definition</p>
<p>All other data in the map are optional, but it’s a good practice to add :doc to explain it and :validation-fn which will help in detecting before evaluation if the vector language is valid</p>
<p>(3) apply-predicate-query can accept additional param, which is a registry it uses to turn predicate query vectors to functions. Here as a first argument to apply-predicate-query, we merge the default predicates registry with our custom one. The default one does not have to be used, although all its keys are namespaced, so there should not be a clash with your registry</p>
</div></div></div></body></html>